<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>AR NFT Debug</title>
  <style>
    html,body { margin:0;padding:0;width:100%;height:100%;background:black;overflow:hidden; }
  </style>
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar-nft.js"></script>
</head>
<body>
  <a-scene embedded
           arjs="sourceType: webcam; trackingMethod: best; debugUIEnabled: true;"
           vr-mode-ui="enabled: false">
    <a-assets>
      <img id="logo" src="logo.jpg" crossorigin="anonymous"/>
    </a-assets>

    <!-- NFT маркер: отладка -->
    <a-nft id="myNFT"
           type="nft"
           url="logo"
           smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5"
           emitevents="true">
      <a-entity id="card" visible="false" scale="0 0 0">
        <a-plane color="#111111" opacity="0.8" width="1.5" height="1"></a-plane>
        <a-image src="#logo" width="0.4" height="0.4" position="-0.5 0.2 0.01"></a-image>
        <a-text value="Иван Иванов" position="0 0.25 0.02" color="#00FFFF" align="center" width="2"></a-text>
        <a-text id="link1" value="LinkedIn" position="-0.4 -0.1 0.02" color="#00FFAA" width="1.5"></a-text>
        <a-text id="link2" value="Twitter" position="0.1 -0.1 0.02" color="#00FFAA" width="1.5"></a-text>
      </a-entity>

      <a-animation begin="markerFound" attribute="scale" from="0 0 0" to="1 1 1" dur="500"
                   easing="ease-out" fill="forwards" target="#card"></a-animation>
      <a-animation begin="markerFound" attribute="visible" from="false" to="true" dur="1"
                   fill="forwards" target="#card"></a-animation>
      <a-animation begin="markerLost" attribute="visible" to="false" dur="1"
                   fill="forwards" target="#card"></a-animation>
    </a-nft>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    const nft = document.getElementById('myNFT');
    const card = document.getElementById('card');
    const l1 = document.getElementById('link1');
    const l2 = document.getElementById('link2');

    // Обработчики для отладки
    nft.addEventListener('arjs-nft-init', () => console.log('[NFT] init'));
    nft.addEventListener('arjs-nft-load', () => console.log('[NFT] load success'));
    nft.addEventListener('arjs-nft-error', () => console.error('[NFT] load ERROR'));
    nft.addEventListener('markerFound', () => console.log('markerFound — показываем визитку'));
    nft.addEventListener('markerLost', () => console.log('markerLost — скрываем визитку'));

    // Клики по ссылкам
    l1.addEventListener('click', () => window.open('https://www.linkedin.com/in/ivan-ivanov','_blank'));
    l2.addEventListener('click', () => window.open('https://twitter.com/ivanivanov','_blank'));

    // Проверяем поток
    document.querySelector('a-scene').addEventListener('renderstart', () => {
      console.log('AR scene started rendering — камера запущена');
    });
  </script>
</body>
</html>
